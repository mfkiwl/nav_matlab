                clear;
                clc;
                close all;

                x = [0.814723686393179,0.913375856139019,0.278498218867048]';
                F = [0.964888535199277         0.957166948242946         0.141886338627215;
                     0.157613081677548         0.485375648722841         0.421761282626275;
                     0.970592781760616           0.8002804688888         0.915735525189067];
                P = blkdiag(0.792207329559554,0.0357116785741896,0.678735154857773);
                Q = blkdiag(0.959492426392903,0.849129305868777,0.757740130578333);
                z = [0.655740699156587,0.933993247757551]';
                R = blkdiag(0.655477890177557,0.706046088019609);
                H = [0.0318328463774207        0.0461713906311539         0.823457828327293;
                       0.27692298496089        0.0971317812358475         0.694828622975817];

                for i = 1:100
                    x = F*x;
                    P = F*P*F' + Q*0.1;
                    K = P * H' / (H * P * H' + R);
                    
                    z = [i-1, (i-1)*2]';

                    % chi squre , see 一种基于软卡方检测的自适应Ｋａｌｍａｎ滤波方法
                    chi = (z - H * x)' * (H * P * H' + R)^(-1)*(z - H * x);

                    x = x + K * (z - H * x)
                    P = (eye(length(x)) - K * H) * P
                    chi
                end